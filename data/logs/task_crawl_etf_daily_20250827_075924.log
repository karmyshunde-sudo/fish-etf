2025-08-27 07:59:25,568 - __main__ - INFO - ===== 开始执行任务：crawl_etf_daily =====
2025-08-27 07:59:25,568 - __main__ - INFO - 当前时间：2025-08-27 15:59:25（北京时间）
2025-08-27 07:59:25,568 - data_crawler - INFO - ===== 开始执行任务：crawl_etf_daily =====
2025-08-27 07:59:25,568 - data_crawler - INFO - 当前时间：2025-08-27 15:59:25（北京时间）
2025-08-27 07:59:25,635 - data_crawler - INFO - ✅ 确保目录存在: /home/runner/work/fish-etf/fish-etf/data/etf_daily
2025-08-27 07:59:25,636 - data_crawler - INFO - 已完成爬取的ETF数量：2
2025-08-27 07:59:25,636 - data_crawler.etf_list_manager - INFO - ℹ️ 无需更新，加载本地ETF列表
2025-08-27 07:59:25,639 - data_crawler.etf_list_manager - INFO - 📊 有效ETF代码数量: 2
2025-08-27 07:59:25,639 - data_crawler - INFO - 待爬取ETF总数：2只
2025-08-27 07:59:25,639 - data_crawler - INFO - 共分为 1 个批次，每批 50 只ETF
2025-08-27 07:59:25,639 - data_crawler - INFO - ==============================
2025-08-27 07:59:25,639 - data_crawler - INFO - 正在处理批次 1/1
2025-08-27 07:59:25,639 - data_crawler - INFO - ETF范围：1-2只（共2只）
2025-08-27 07:59:25,639 - data_crawler - INFO - ==============================
2025-08-27 07:59:25,639 - data_crawler - INFO - --- 批次1 - 第1只 / 共2只 ---
2025-08-27 07:59:25,639 - data_crawler.etf_list_manager - INFO - ℹ️ 无需更新，加载本地ETF列表
2025-08-27 07:59:25,641 - data_crawler - INFO - ETF代码：563770 | 名称：全指现金流ETF
2025-08-27 07:59:25,642 - data_crawler - INFO - 📅 爬取时间范围：2000-01-01 至 2025-08-27
2025-08-27 07:59:25,642 - data_crawler.akshare_crawler - ERROR - AkShare爬取563770失败：module 'akshare' has no attribute 'etf_spot_em'
2025-08-27 07:59:27,644 - data_crawler.akshare_crawler - ERROR - AkShare爬取563770失败：module 'akshare' has no attribute 'etf_spot_em'
2025-08-27 07:59:29,646 - data_crawler.akshare_crawler - ERROR - AkShare爬取563770失败：module 'akshare' has no attribute 'etf_spot_em'
2025-08-27 07:59:29,646 - data_crawler - ERROR - ❌ 爬取失败：module 'akshare' has no attribute 'etf_spot_em'
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 170, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 212, in call
    raise attempt.get()
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 247, in get
    six.reraise(self.value[0], self.value[1], self.value[2])
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/six.py", line 724, in reraise
    raise value
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 200, in call
    attempt = Attempt(fn(*args, **kwargs), attempt_number, False)
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/akshare_crawler.py", line 21, in crawl_etf_daily_akshare
    df = ak.etf_spot_em(symbol=etf_code, start_date=start_date, end_date=end_date)
AttributeError: module 'akshare' has no attribute 'etf_spot_em'
2025-08-27 07:59:32,650 - data_crawler - INFO - --- 批次1 - 第2只 / 共2只 ---
2025-08-27 07:59:32,651 - data_crawler.etf_list_manager - INFO - ℹ️ 无需更新，加载本地ETF列表
2025-08-27 07:59:32,653 - data_crawler - INFO - ETF代码：563680 | 名称：800自由现金流ETF
2025-08-27 07:59:32,653 - data_crawler - INFO - 📅 爬取时间范围：2000-01-01 至 2025-08-27
2025-08-27 07:59:32,653 - data_crawler.akshare_crawler - ERROR - AkShare爬取563680失败：module 'akshare' has no attribute 'etf_spot_em'
2025-08-27 07:59:34,656 - data_crawler.akshare_crawler - ERROR - AkShare爬取563680失败：module 'akshare' has no attribute 'etf_spot_em'
2025-08-27 07:59:36,658 - data_crawler.akshare_crawler - ERROR - AkShare爬取563680失败：module 'akshare' has no attribute 'etf_spot_em'
2025-08-27 07:59:36,658 - data_crawler - ERROR - ❌ 爬取失败：module 'akshare' has no attribute 'etf_spot_em'
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 170, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 212, in call
    raise attempt.get()
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 247, in get
    six.reraise(self.value[0], self.value[1], self.value[2])
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/six.py", line 724, in reraise
    raise value
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 200, in call
    attempt = Attempt(fn(*args, **kwargs), attempt_number, False)
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/akshare_crawler.py", line 21, in crawl_etf_daily_akshare
    df = ak.etf_spot_em(symbol=etf_code, start_date=start_date, end_date=end_date)
AttributeError: module 'akshare' has no attribute 'etf_spot_em'
2025-08-27 07:59:39,661 - data_crawler - INFO - ===== 所有待爬取ETF处理完毕 =====
2025-08-27 07:59:39,662 - __main__ - INFO - ===== 任务执行结束：success =====
{
  "status": "success",
  "task": "crawl_etf_daily",
  "message": "ETF日线数据增量爬取完成"
}
