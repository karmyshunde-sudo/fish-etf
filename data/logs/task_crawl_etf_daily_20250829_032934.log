2025-08-29 03:29:34,044 - root - INFO - 创建目录: /home/runner/work/fish-etf/fish-etf/logs
2025-08-29 03:29:34,044 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 03:29:34,044 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 03:29:34,044 - root - INFO - 配置初始化完成
2025-08-29 03:29:35,315 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 03:29:35,315 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 03:29:35,315 - data_crawler.etf_list_manager - INFO - ETF列表管理器初始化完成
2025-08-29 03:29:35,317 - data_crawler.akshare_crawler - INFO - AkShare爬虫模块初始化完成
2025-08-29 03:29:35,320 - data_crawler.sina_crawler - INFO - 新浪爬虫模块初始化完成
2025-08-29 03:29:35,334 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 03:29:35,334 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 03:29:35,334 - data_crawler - INFO - 开始更新ETF列表
2025-08-29 03:29:35,334 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 03:29:35,334 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 03:29:35,334 - data_crawler.etf_list_manager - INFO - ℹ️ 无需更新，加载本地ETF列表
2025-08-29 03:29:35,338 - data_crawler - INFO - ETF列表更新成功，共9只ETF
2025-08-29 03:29:35,338 - data_crawler - INFO - 数据爬取模块初始化完成
2025-08-29 03:29:35,348 - strategy.arbitrage - INFO - 套利策略模块初始化完成
2025-08-29 03:29:35,351 - strategy.position - INFO - 仓位管理模块初始化完成
2025-08-29 03:29:35,352 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 03:29:35,352 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 03:29:35,352 - strategy - INFO - 策略模块初始化完成
2025-08-29 03:29:35,354 - wechat_push.push - INFO - 微信推送模块初始化完成
2025-08-29 03:29:35,354 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 03:29:35,354 - __main__ - INFO - ===== 开始执行任务：crawl_etf_daily =====
2025-08-29 03:29:35,354 - __main__ - INFO - 当前时间：2025-08-29 11:29:35（北京时间）
2025-08-29 03:29:35,355 - __main__ - INFO - 环境设置完成
2025-08-29 03:29:35,355 - __main__ - INFO - 开始执行ETF日线数据增量爬取
2025-08-29 03:29:35,355 - data_crawler - INFO - ===== 开始执行任务：crawl_etf_daily =====
2025-08-29 03:29:35,355 - data_crawler - INFO - 当前时间：2025-08-29 11:29:35（北京时间）
2025-08-29 03:29:35,421 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 03:29:35,422 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 03:29:35,422 - data_crawler - INFO - ✅ 确保目录存在: /home/runner/work/fish-etf/fish-etf/data/etf_daily
2025-08-29 03:29:35,422 - data_crawler - INFO - 已完成爬取的ETF数量：2
2025-08-29 03:29:35,422 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 03:29:35,422 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 03:29:35,422 - data_crawler.etf_list_manager - INFO - ℹ️ 无需更新，加载本地ETF列表
2025-08-29 03:29:35,425 - data_crawler.etf_list_manager - INFO - 📊 有效ETF代码数量: 9
2025-08-29 03:29:35,426 - data_crawler - INFO - 待爬取ETF总数：9只
2025-08-29 03:29:35,426 - data_crawler - INFO - 共分为 1 个批次，每批 50 只ETF
2025-08-29 03:29:35,426 - data_crawler - INFO - ==============================
2025-08-29 03:29:35,426 - data_crawler - INFO - 正在处理批次 1/1
2025-08-29 03:29:35,426 - data_crawler - INFO - ETF范围：1-9只（共9只）
2025-08-29 03:29:35,426 - data_crawler - INFO - ==============================
2025-08-29 03:29:35,426 - data_crawler - INFO - --- 批次1 - 第1只 / 共9只 ---
2025-08-29 03:29:35,426 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 03:29:35,426 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 03:29:35,426 - data_crawler.etf_list_manager - INFO - ℹ️ 无需更新，加载本地ETF列表
2025-08-29 03:29:35,429 - data_crawler - INFO - ETF代码：515980 | 名称：人工智能ETF
2025-08-29 03:29:35,429 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:29:35,429 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 515980 的数据，时间范围：2024-08-29 至 2025-08-29
  0%|          | 0/12 [00:00<?, ?it/s]                                      2025-08-29 03:29:53,705 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_em 接口调用失败: HTTPSConnectionPool(host='88.push2.eastmoney.com', port=443): Max retries exceeded with url: /api/qt/clist/get?pn=2&pz=100&po=1&np=1&ut=bd1d9ddb04089700cf9c27f6f7426281&fltt=2&invt=2&wbp2u=%7C0%7C0%7C0%7Cweb&fid=f3&fs=b%3AMK0021%2Cb%3AMK0022%2Cb%3AMK0023%2Cb%3AMK0024&fields=f3%2Cf12%2Cf13 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fac9e6c3f70>: Failed to establish a new connection: [Errno 101] Network is unreachable'))
2025-08-29 03:29:53,706 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:29:53,706 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:29:53,706 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 515980 数据
2025-08-29 03:29:53,707 - data_crawler.akshare_crawler - WARNING - AkShare未获取到515980数据（2024-08-29至2025-08-29）
2025-08-29 03:29:55,709 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 515980 的数据，时间范围：2024-08-29 至 2025-08-29
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:16,  1.48s/it] 17%|█▋        | 2/12 [00:02<00:14,  1.48s/it] 25%|██▌       | 3/12 [00:04<00:14,  1.61s/it]                                              2025-08-29 03:30:16,933 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_em 接口调用失败: HTTPSConnectionPool(host='88.push2.eastmoney.com', port=443): Max retries exceeded with url: /api/qt/clist/get?pn=5&pz=100&po=1&np=1&ut=bd1d9ddb04089700cf9c27f6f7426281&fltt=2&invt=2&wbp2u=%7C0%7C0%7C0%7Cweb&fid=f3&fs=b%3AMK0021%2Cb%3AMK0022%2Cb%3AMK0023%2Cb%3AMK0024&fields=f3%2Cf12%2Cf13 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fac9e6c1d50>: Failed to establish a new connection: [Errno 101] Network is unreachable'))
2025-08-29 03:30:16,934 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:30:16,934 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:30:16,934 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 515980 数据
2025-08-29 03:30:16,935 - data_crawler.akshare_crawler - WARNING - AkShare未获取到515980数据（2024-08-29至2025-08-29）
2025-08-29 03:30:18,937 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 515980 的数据，时间范围：2024-08-29 至 2025-08-29
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:16,  1.49s/it] 17%|█▋        | 2/12 [00:02<00:14,  1.47s/it] 25%|██▌       | 3/12 [00:04<00:13,  1.47s/it]                                              2025-08-29 03:30:39,835 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_em 接口调用失败: HTTPSConnectionPool(host='88.push2.eastmoney.com', port=443): Max retries exceeded with url: /api/qt/clist/get?pn=5&pz=100&po=1&np=1&ut=bd1d9ddb04089700cf9c27f6f7426281&fltt=2&invt=2&wbp2u=%7C0%7C0%7C0%7Cweb&fid=f3&fs=b%3AMK0021%2Cb%3AMK0022%2Cb%3AMK0023%2Cb%3AMK0024&fields=f3%2Cf12%2Cf13 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fac9e702680>: Failed to establish a new connection: [Errno 101] Network is unreachable'))
2025-08-29 03:30:39,836 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:30:39,836 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:30:39,837 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 515980 数据
2025-08-29 03:30:39,837 - data_crawler.akshare_crawler - WARNING - AkShare未获取到515980数据（2024-08-29至2025-08-29）
2025-08-29 03:30:39,838 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 03:30:42,843 - data_crawler - INFO - --- 批次1 - 第2只 / 共9只 ---
2025-08-29 03:30:42,844 - data_crawler - INFO - ETF代码：159325 | 名称：半导体ETF南方
2025-08-29 03:30:42,845 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:30:42,845 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159325 的数据，时间范围：2024-08-29 至 2025-08-29
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:18,  1.66s/it] 17%|█▋        | 2/12 [00:03<00:16,  1.64s/it] 25%|██▌       | 3/12 [00:04<00:14,  1.65s/it] 33%|███▎      | 4/12 [00:06<00:12,  1.62s/it] 42%|████▏     | 5/12 [00:08<00:11,  1.63s/it] 50%|█████     | 6/12 [00:09<00:09,  1.62s/it] 58%|█████▊    | 7/12 [00:11<00:08,  1.64s/it] 67%|██████▋   | 8/12 [00:13<00:06,  1.63s/it] 75%|███████▌  | 9/12 [00:14<00:04,  1.64s/it] 83%|████████▎ | 10/12 [00:16<00:03,  1.65s/it] 92%|█████████▏| 11/12 [00:18<00:01,  1.85s/it]100%|██████████| 12/12 [00:20<00:00,  1.78s/it]                                               2025-08-29 03:31:06,855 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:06,855 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:06,856 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159325 数据
2025-08-29 03:31:06,856 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159325数据（2024-08-29至2025-08-29）
2025-08-29 03:31:08,858 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159325 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:09,563 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:09,564 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:09,564 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159325 数据
2025-08-29 03:31:09,564 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159325数据（2024-08-29至2025-08-29）
2025-08-29 03:31:11,567 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159325 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:12,274 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:12,275 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:12,275 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159325 数据
2025-08-29 03:31:12,275 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159325数据（2024-08-29至2025-08-29）
2025-08-29 03:31:12,276 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 03:31:15,280 - data_crawler - INFO - --- 批次1 - 第3只 / 共9只 ---
2025-08-29 03:31:15,282 - data_crawler - INFO - ETF代码：159696 | 名称：纳指ETF易方达
2025-08-29 03:31:15,282 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:15,282 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159696 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:15,974 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:15,975 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:15,975 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159696 数据
2025-08-29 03:31:15,975 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159696数据（2024-08-29至2025-08-29）
2025-08-29 03:31:17,978 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159696 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:18,682 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:18,683 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:18,683 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159696 数据
2025-08-29 03:31:18,683 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159696数据（2024-08-29至2025-08-29）
2025-08-29 03:31:20,686 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159696 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:21,391 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:21,392 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:21,392 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159696 数据
2025-08-29 03:31:21,392 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159696数据（2024-08-29至2025-08-29）
2025-08-29 03:31:21,393 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 03:31:24,395 - data_crawler - INFO - --- 批次1 - 第4只 / 共9只 ---
2025-08-29 03:31:24,397 - data_crawler - INFO - ETF代码：588840 | 名称：科创板50ETF基金
2025-08-29 03:31:24,397 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:24,397 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 588840 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:25,091 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:25,091 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:25,092 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 588840 数据
2025-08-29 03:31:25,092 - data_crawler.akshare_crawler - WARNING - AkShare未获取到588840数据（2024-08-29至2025-08-29）
2025-08-29 03:31:27,094 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 588840 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:27,798 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:27,798 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:27,799 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 588840 数据
2025-08-29 03:31:27,799 - data_crawler.akshare_crawler - WARNING - AkShare未获取到588840数据（2024-08-29至2025-08-29）
2025-08-29 03:31:29,801 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 588840 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:30,509 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:30,510 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:30,510 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 588840 数据
2025-08-29 03:31:30,510 - data_crawler.akshare_crawler - WARNING - AkShare未获取到588840数据（2024-08-29至2025-08-29）
2025-08-29 03:31:30,511 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 03:31:33,515 - data_crawler - INFO - --- 批次1 - 第5只 / 共9只 ---
2025-08-29 03:31:33,517 - data_crawler - INFO - ETF代码：159906 | 名称：深成长龙头ETF
2025-08-29 03:31:33,517 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:33,517 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159906 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:34,216 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:34,217 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:34,217 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159906 数据
2025-08-29 03:31:34,217 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159906数据（2024-08-29至2025-08-29）
2025-08-29 03:31:36,220 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159906 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:36,948 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:36,949 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:36,949 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159906 数据
2025-08-29 03:31:36,949 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159906数据（2024-08-29至2025-08-29）
2025-08-29 03:31:38,952 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159906 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:39,658 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:39,659 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:39,659 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159906 数据
2025-08-29 03:31:39,660 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159906数据（2024-08-29至2025-08-29）
2025-08-29 03:31:39,660 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 03:31:42,664 - data_crawler - INFO - --- 批次1 - 第6只 / 共9只 ---
2025-08-29 03:31:42,666 - data_crawler - INFO - ETF代码：515750 | 名称：科技50ETF
2025-08-29 03:31:42,666 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:42,666 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 515750 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:43,366 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:43,367 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:43,367 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 515750 数据
2025-08-29 03:31:43,367 - data_crawler.akshare_crawler - WARNING - AkShare未获取到515750数据（2024-08-29至2025-08-29）
2025-08-29 03:31:45,370 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 515750 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:46,074 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:46,075 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:46,075 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 515750 数据
2025-08-29 03:31:46,075 - data_crawler.akshare_crawler - WARNING - AkShare未获取到515750数据（2024-08-29至2025-08-29）
2025-08-29 03:31:48,078 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 515750 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:48,785 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:48,785 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:48,785 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 515750 数据
2025-08-29 03:31:48,786 - data_crawler.akshare_crawler - WARNING - AkShare未获取到515750数据（2024-08-29至2025-08-29）
2025-08-29 03:31:48,786 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 03:31:51,790 - data_crawler - INFO - --- 批次1 - 第7只 / 共9只 ---
2025-08-29 03:31:51,792 - data_crawler - INFO - ETF代码：513030 | 名称：德国ETF
2025-08-29 03:31:51,792 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:51,792 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 513030 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:52,483 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:52,484 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:52,484 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 513030 数据
2025-08-29 03:31:52,484 - data_crawler.akshare_crawler - WARNING - AkShare未获取到513030数据（2024-08-29至2025-08-29）
2025-08-29 03:31:54,486 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 513030 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:55,194 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:55,195 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:55,195 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 513030 数据
2025-08-29 03:31:55,195 - data_crawler.akshare_crawler - WARNING - AkShare未获取到513030数据（2024-08-29至2025-08-29）
2025-08-29 03:31:57,198 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 513030 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:31:57,904 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:31:57,905 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:31:57,905 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 513030 数据
2025-08-29 03:31:57,905 - data_crawler.akshare_crawler - WARNING - AkShare未获取到513030数据（2024-08-29至2025-08-29）
2025-08-29 03:31:57,906 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 03:32:00,910 - data_crawler - INFO - --- 批次1 - 第8只 / 共9只 ---
2025-08-29 03:32:00,912 - data_crawler - INFO - ETF代码：159679 | 名称：中证1000增强ETF
2025-08-29 03:32:00,912 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:32:00,912 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159679 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:32:01,609 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:32:01,609 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:32:01,610 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159679 数据
2025-08-29 03:32:01,610 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159679数据（2024-08-29至2025-08-29）
2025-08-29 03:32:03,612 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159679 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:32:04,326 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:32:04,327 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:32:04,327 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159679 数据
2025-08-29 03:32:04,328 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159679数据（2024-08-29至2025-08-29）
2025-08-29 03:32:06,330 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159679 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:32:07,211 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:32:07,211 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:32:07,212 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159679 数据
2025-08-29 03:32:07,212 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159679数据（2024-08-29至2025-08-29）
2025-08-29 03:32:07,213 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 03:32:10,216 - data_crawler - INFO - --- 批次1 - 第9只 / 共9只 ---
2025-08-29 03:32:10,217 - data_crawler - INFO - ETF代码：513730 | 名称：东南亚科技ETF
2025-08-29 03:32:10,218 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:32:10,218 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 513730 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:32:10,778 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:32:10,779 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:32:10,779 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 513730 数据
2025-08-29 03:32:10,779 - data_crawler.akshare_crawler - WARNING - AkShare未获取到513730数据（2024-08-29至2025-08-29）
2025-08-29 03:32:12,782 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 513730 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:32:13,412 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:32:13,413 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:32:13,413 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 513730 数据
2025-08-29 03:32:13,414 - data_crawler.akshare_crawler - WARNING - AkShare未获取到513730数据（2024-08-29至2025-08-29）
2025-08-29 03:32:15,416 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 513730 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 03:32:15,984 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 03:32:15,984 - data_crawler.akshare_crawler - WARNING - etf_hist_em 接口调用失败: module 'akshare' has no attribute 'etf_hist_em'
2025-08-29 03:32:15,985 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 513730 数据
2025-08-29 03:32:15,985 - data_crawler.akshare_crawler - WARNING - AkShare未获取到513730数据（2024-08-29至2025-08-29）
2025-08-29 03:32:15,986 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 03:32:18,990 - data_crawler - INFO - ===== 所有待爬取ETF处理完毕 =====
2025-08-29 03:32:18,990 - __main__ - INFO - ===== 任务执行结束：success =====
{
  "status": "success",
  "task": "crawl_etf_daily",
  "message": "ETF日线数据增量爬取完成"
}
