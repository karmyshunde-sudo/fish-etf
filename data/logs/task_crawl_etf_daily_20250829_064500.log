2025-08-29 06:45:00,743 - root - INFO - 创建目录: /home/runner/work/fish-etf/fish-etf/logs
2025-08-29 06:45:00,743 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 06:45:00,744 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 06:45:00,744 - root - INFO - 配置初始化完成
2025-08-29 06:45:02,238 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 06:45:02,238 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 06:45:02,238 - data_crawler.etf_list_manager - INFO - ETF列表管理器初始化完成
2025-08-29 06:45:02,240 - data_crawler.akshare_crawler - INFO - AkShare爬虫模块初始化完成
2025-08-29 06:45:02,242 - data_crawler.sina_crawler - INFO - 新浪爬虫模块初始化完成
2025-08-29 06:45:02,257 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 06:45:02,257 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 06:45:02,257 - data_crawler - INFO - 开始更新ETF列表
2025-08-29 06:45:02,257 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 06:45:02,257 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 06:45:02,257 - data_crawler.etf_list_manager - INFO - ℹ️ 无需更新，加载本地ETF列表
2025-08-29 06:45:02,261 - data_crawler - INFO - ETF列表更新成功，共9只ETF
2025-08-29 06:45:02,261 - data_crawler - INFO - 数据爬取模块初始化完成
2025-08-29 06:45:02,272 - strategy.arbitrage - INFO - 套利策略模块初始化完成
2025-08-29 06:45:02,275 - strategy.position - INFO - 仓位管理模块初始化完成
2025-08-29 06:45:02,276 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 06:45:02,276 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 06:45:02,276 - strategy - INFO - 策略模块初始化完成
2025-08-29 06:45:02,278 - wechat_push.push - INFO - 微信推送模块初始化完成
2025-08-29 06:45:02,278 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 06:45:02,278 - __main__ - INFO - ===== 开始执行任务：crawl_etf_daily =====
2025-08-29 06:45:02,278 - __main__ - INFO - 当前时间：2025-08-29 14:45:02（北京时间）
2025-08-29 06:45:02,279 - __main__ - INFO - 环境设置完成
2025-08-29 06:45:02,279 - __main__ - INFO - 开始执行ETF日线数据增量爬取
2025-08-29 06:45:02,279 - data_crawler - INFO - ===== 开始执行任务：crawl_etf_daily =====
2025-08-29 06:45:02,279 - data_crawler - INFO - 当前时间：2025-08-29 14:45:02（北京时间）
2025-08-29 06:45:02,346 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 06:45:02,347 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 06:45:02,347 - data_crawler - INFO - ✅ 确保目录存在: /home/runner/work/fish-etf/fish-etf/data/etf_daily
2025-08-29 06:45:02,347 - data_crawler - INFO - 已完成爬取的ETF数量：2
2025-08-29 06:45:02,347 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 06:45:02,347 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 06:45:02,347 - data_crawler.etf_list_manager - INFO - ℹ️ 无需更新，加载本地ETF列表
2025-08-29 06:45:02,351 - data_crawler.etf_list_manager - INFO - 📊 有效ETF代码数量: 9
2025-08-29 06:45:02,351 - data_crawler - INFO - 待爬取ETF总数：9只
2025-08-29 06:45:02,351 - data_crawler - INFO - 共分为 1 个批次，每批 50 只ETF
2025-08-29 06:45:02,351 - data_crawler - INFO - ==============================
2025-08-29 06:45:02,351 - data_crawler - INFO - 正在处理批次 1/1
2025-08-29 06:45:02,351 - data_crawler - INFO - ETF范围：1-9只（共9只）
2025-08-29 06:45:02,351 - data_crawler - INFO - ==============================
2025-08-29 06:45:02,351 - data_crawler - INFO - --- 批次1 - 第1只 / 共9只 ---
2025-08-29 06:45:02,351 - root - INFO - 日志文件已配置: /home/runner/work/fish-etf/fish-etf/logs/etf_strategy.log
2025-08-29 06:45:02,351 - root - ERROR - 初始化目录失败: type object 'Config' has no attribute 'get_wecom_webhook'
2025-08-29 06:45:02,352 - data_crawler.etf_list_manager - INFO - ℹ️ 无需更新，加载本地ETF列表
2025-08-29 06:45:02,354 - data_crawler - INFO - ETF代码：515980 | 名称：人工智能ETF
2025-08-29 06:45:02,354 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:02,355 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 515980 的数据，时间范围：2024-08-29 至 2025-08-29
AkShare版本: 1.17.42
['amac_fund_abs', 'amac_fund_account_info', 'amac_fund_info', 'amac_fund_sub_info', 'amac_person_fund_org_list', 'fund', 'fund_announcement_personnel_em', 'fund_aum_em', 'fund_aum_hist_em', 'fund_aum_trend_em', 'fund_balance_position_lg', 'fund_cf_em', 'fund_etf_category_sina', 'fund_etf_dividend_sina', 'fund_etf_fund_daily_em', 'fund_etf_fund_info_em', 'fund_etf_hist_em', 'fund_etf_hist_min_em', 'fund_etf_hist_sina', 'fund_etf_spot_em', 'fund_etf_spot_ths', 'fund_exchange_rank_em', 'fund_fee_em', 'fund_fh_em', 'fund_fh_rank_em', 'fund_financial_fund_daily_em', 'fund_financial_fund_info_em', 'fund_graded_fund_daily_em', 'fund_graded_fund_info_em', 'fund_hk_fund_hist_em', 'fund_hk_rank_em', 'fund_hold_structure_em', 'fund_individual_achievement_xq', 'fund_individual_analysis_xq', 'fund_individual_basic_info_xq', 'fund_individual_detail_hold_xq', 'fund_individual_detail_info_xq', 'fund_individual_profit_probability_xq', 'fund_info_index_em', 'fund_lcx_rank_em', 'fund_linghuo_position_lg', 'fund_lof_hist_em', 'fund_lof_hist_min_em', 'fund_lof_spot_em', 'fund_manager_em', 'fund_money_fund_daily_em', 'fund_money_fund_info_em', 'fund_money_rank_em', 'fund_name_em', 'fund_new_found_em', 'fund_open_fund_daily_em', 'fund_open_fund_info_em', 'fund_open_fund_rank_em', 'fund_portfolio_bond_hold_em', 'fund_portfolio_change_em', 'fund_portfolio_hold_em', 'fund_portfolio_industry_allocation_em', 'fund_purchase_em', 'fund_rating_all', 'fund_rating_ja', 'fund_rating_sh', 'fund_rating_zs', 'fund_report_asset_allocation_cninfo', 'fund_report_industry_allocation_cninfo', 'fund_report_stock_cninfo', 'fund_scale_change_em', 'fund_scale_close_sina', 'fund_scale_open_sina', 'fund_scale_structured_sina', 'fund_stock_position_lg', 'fund_value_estimation_em', 'get_qhkc_fund_bs', 'get_qhkc_fund_money_change', 'get_qhkc_fund_position', 'index_hist_fund_sw', 'index_option_100etf_min_qvix', 'index_option_100etf_qvix', 'index_option_300etf_min_qvix', 'index_option_300etf_qvix', 'index_option_500etf_min_qvix', 'index_option_500etf_qvix', 'index_option_50etf_min_qvix', 'index_option_50etf_qvix', 'index_realtime_fund_sw', 'stock_concept_fund_flow_hist', 'stock_fund_flow_big_deal', 'stock_fund_flow_concept', 'stock_fund_flow_individual', 'stock_fund_flow_industry', 'stock_fund_stock_holder', 'stock_fundamental', 'stock_hsgt_fund_flow_summary_em', 'stock_hsgt_fund_min_em', 'stock_individual_fund_flow', 'stock_individual_fund_flow_rank', 'stock_individual_fund_flow_rank_async', 'stock_main_fund_flow', 'stock_market_fund_flow', 'stock_report_fund_hold', 'stock_report_fund_hold_detail', 'stock_sector_fund_flow_hist', 'stock_sector_fund_flow_rank', 'stock_sector_fund_flow_summary']
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:01<00:16,  1.54s/it] 17%|█▋        | 2/12 [00:02<00:14,  1.49s/it] 25%|██▌       | 3/12 [00:04<00:13,  1.47s/it] 33%|███▎      | 4/12 [00:06<00:15,  1.88s/it] 42%|████▏     | 5/12 [00:08<00:12,  1.75s/it] 50%|█████     | 6/12 [00:09<00:09,  1.66s/it] 58%|█████▊    | 7/12 [00:11<00:07,  1.60s/it] 67%|██████▋   | 8/12 [00:14<00:08,  2.21s/it] 75%|███████▌  | 9/12 [00:16<00:05,  1.97s/it] 83%|████████▎ | 10/12 [00:18<00:04,  2.06s/it] 92%|█████████▏| 11/12 [00:20<00:02,  2.12s/it]100%|██████████| 12/12 [00:22<00:00,  1.92s/it]                                               2025-08-29 06:45:28,311 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:45:28,311 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 515980 数据
2025-08-29 06:45:28,312 - data_crawler.akshare_crawler - WARNING - AkShare未获取到515980数据（2024-08-29至2025-08-29）
2025-08-29 06:45:30,314 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 515980 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:30,876 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:45:30,877 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 515980 数据
2025-08-29 06:45:30,877 - data_crawler.akshare_crawler - WARNING - AkShare未获取到515980数据（2024-08-29至2025-08-29）
2025-08-29 06:45:32,880 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 515980 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:33,464 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:45:33,465 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 515980 数据
2025-08-29 06:45:33,465 - data_crawler.akshare_crawler - WARNING - AkShare未获取到515980数据（2024-08-29至2025-08-29）
2025-08-29 06:45:33,466 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 06:45:36,471 - data_crawler - INFO - --- 批次1 - 第2只 / 共9只 ---
2025-08-29 06:45:36,472 - data_crawler - INFO - ETF代码：159325 | 名称：半导体ETF南方
2025-08-29 06:45:36,473 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:36,473 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159325 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:37,032 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:45:37,032 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159325 数据
2025-08-29 06:45:37,033 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159325数据（2024-08-29至2025-08-29）
2025-08-29 06:45:39,035 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159325 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:39,601 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:45:39,601 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159325 数据
2025-08-29 06:45:39,602 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159325数据（2024-08-29至2025-08-29）
2025-08-29 06:45:41,604 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159325 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:42,185 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:45:42,185 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159325 数据
2025-08-29 06:45:42,186 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159325数据（2024-08-29至2025-08-29）
2025-08-29 06:45:42,186 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 06:45:45,191 - data_crawler - INFO - --- 批次1 - 第3只 / 共9只 ---
2025-08-29 06:45:45,192 - data_crawler - INFO - ETF代码：159696 | 名称：纳指ETF易方达
2025-08-29 06:45:45,192 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:45,192 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159696 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:45,752 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:45:45,753 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159696 数据
2025-08-29 06:45:45,753 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159696数据（2024-08-29至2025-08-29）
2025-08-29 06:45:47,755 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159696 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:48,316 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:45:48,317 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159696 数据
2025-08-29 06:45:48,317 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159696数据（2024-08-29至2025-08-29）
2025-08-29 06:45:50,319 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159696 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:50,901 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:45:50,901 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159696 数据
2025-08-29 06:45:50,901 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159696数据（2024-08-29至2025-08-29）
2025-08-29 06:45:50,902 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 06:45:53,906 - data_crawler - INFO - --- 批次1 - 第4只 / 共9只 ---
2025-08-29 06:45:53,908 - data_crawler - INFO - ETF代码：588840 | 名称：科创板50ETF基金
2025-08-29 06:45:53,908 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:53,908 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 588840 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:54,472 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:45:54,473 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 588840 数据
2025-08-29 06:45:54,473 - data_crawler.akshare_crawler - WARNING - AkShare未获取到588840数据（2024-08-29至2025-08-29）
2025-08-29 06:45:56,475 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 588840 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:57,050 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:45:57,050 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 588840 数据
2025-08-29 06:45:57,050 - data_crawler.akshare_crawler - WARNING - AkShare未获取到588840数据（2024-08-29至2025-08-29）
2025-08-29 06:45:59,053 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 588840 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:45:59,636 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:45:59,637 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 588840 数据
2025-08-29 06:45:59,637 - data_crawler.akshare_crawler - WARNING - AkShare未获取到588840数据（2024-08-29至2025-08-29）
2025-08-29 06:45:59,638 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 06:46:02,642 - data_crawler - INFO - --- 批次1 - 第5只 / 共9只 ---
2025-08-29 06:46:02,644 - data_crawler - INFO - ETF代码：159906 | 名称：深成长龙头ETF
2025-08-29 06:46:02,644 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:02,644 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159906 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:03,202 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:03,202 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159906 数据
2025-08-29 06:46:03,203 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159906数据（2024-08-29至2025-08-29）
2025-08-29 06:46:05,205 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159906 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:05,767 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:05,768 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159906 数据
2025-08-29 06:46:05,768 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159906数据（2024-08-29至2025-08-29）
2025-08-29 06:46:07,770 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159906 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:08,355 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:08,356 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159906 数据
2025-08-29 06:46:08,356 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159906数据（2024-08-29至2025-08-29）
2025-08-29 06:46:08,357 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 06:46:11,361 - data_crawler - INFO - --- 批次1 - 第6只 / 共9只 ---
2025-08-29 06:46:11,362 - data_crawler - INFO - ETF代码：515750 | 名称：科技50ETF
2025-08-29 06:46:11,362 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:11,362 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 515750 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:11,921 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:11,922 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 515750 数据
2025-08-29 06:46:11,922 - data_crawler.akshare_crawler - WARNING - AkShare未获取到515750数据（2024-08-29至2025-08-29）
2025-08-29 06:46:13,924 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 515750 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:14,512 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:14,513 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 515750 数据
2025-08-29 06:46:14,513 - data_crawler.akshare_crawler - WARNING - AkShare未获取到515750数据（2024-08-29至2025-08-29）
2025-08-29 06:46:16,515 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 515750 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:17,099 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:17,099 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 515750 数据
2025-08-29 06:46:17,100 - data_crawler.akshare_crawler - WARNING - AkShare未获取到515750数据（2024-08-29至2025-08-29）
2025-08-29 06:46:17,100 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 06:46:20,105 - data_crawler - INFO - --- 批次1 - 第7只 / 共9只 ---
2025-08-29 06:46:20,106 - data_crawler - INFO - ETF代码：513030 | 名称：德国ETF
2025-08-29 06:46:20,106 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:20,107 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 513030 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:20,718 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:20,719 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 513030 数据
2025-08-29 06:46:20,719 - data_crawler.akshare_crawler - WARNING - AkShare未获取到513030数据（2024-08-29至2025-08-29）
2025-08-29 06:46:22,722 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 513030 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:23,284 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:23,285 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 513030 数据
2025-08-29 06:46:23,285 - data_crawler.akshare_crawler - WARNING - AkShare未获取到513030数据（2024-08-29至2025-08-29）
2025-08-29 06:46:25,287 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 513030 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:25,868 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:25,869 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 513030 数据
2025-08-29 06:46:25,869 - data_crawler.akshare_crawler - WARNING - AkShare未获取到513030数据（2024-08-29至2025-08-29）
2025-08-29 06:46:25,870 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 06:46:28,874 - data_crawler - INFO - --- 批次1 - 第8只 / 共9只 ---
2025-08-29 06:46:28,876 - data_crawler - INFO - ETF代码：159679 | 名称：中证1000增强ETF
2025-08-29 06:46:28,876 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:28,876 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159679 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:30,322 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:30,323 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159679 数据
2025-08-29 06:46:30,323 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159679数据（2024-08-29至2025-08-29）
2025-08-29 06:46:32,325 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159679 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:33,374 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:33,374 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159679 数据
2025-08-29 06:46:33,375 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159679数据（2024-08-29至2025-08-29）
2025-08-29 06:46:35,377 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 159679 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:37,123 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:37,123 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 159679 数据
2025-08-29 06:46:37,124 - data_crawler.akshare_crawler - WARNING - AkShare未获取到159679数据（2024-08-29至2025-08-29）
2025-08-29 06:46:37,124 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 06:46:40,128 - data_crawler - INFO - --- 批次1 - 第9只 / 共9只 ---
2025-08-29 06:46:40,130 - data_crawler - INFO - ETF代码：513730 | 名称：东南亚科技ETF
2025-08-29 06:46:40,130 - data_crawler - INFO - 📅 爬取时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:40,130 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 513730 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:41,912 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:41,912 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 513730 数据
2025-08-29 06:46:41,913 - data_crawler.akshare_crawler - WARNING - AkShare未获取到513730数据（2024-08-29至2025-08-29）
2025-08-29 06:46:43,915 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 513730 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:44,937 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:44,938 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 513730 数据
2025-08-29 06:46:44,938 - data_crawler.akshare_crawler - WARNING - AkShare未获取到513730数据（2024-08-29至2025-08-29）
2025-08-29 06:46:46,941 - data_crawler.akshare_crawler - INFO - 开始爬取ETF 513730 的数据，时间范围：2024-08-29 至 2025-08-29
2025-08-29 06:46:47,976 - data_crawler.akshare_crawler - WARNING - fund_etf_hist_sina 接口调用失败: fund_etf_hist_sina() got an unexpected keyword argument 'period'
2025-08-29 06:46:47,977 - data_crawler.akshare_crawler - WARNING - 所有AkShare接口均无法获取ETF 513730 数据
2025-08-29 06:46:47,977 - data_crawler.akshare_crawler - WARNING - AkShare未获取到513730数据（2024-08-29至2025-08-29）
2025-08-29 06:46:47,978 - data_crawler - ERROR - ❌ 爬取失败：RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
Traceback (most recent call last):
  File "/home/runner/work/fish-etf/fish-etf/data_crawler/__init__.py", line 235, in crawl_etf_daily_incremental
    df = crawl_etf_daily_akshare(etf_code, start_date, end_date)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 49, in wrapped_f
    return Retrying(*dargs, **dkw).call(f, *args, **kw)
  File "/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/retrying.py", line 214, in call
    raise RetryError(attempt)
retrying.RetryError: RetryError[Attempts: 3, Value: Empty DataFrame
Columns: []
Index: []]
2025-08-29 06:46:50,982 - data_crawler - INFO - ===== 所有待爬取ETF处理完毕 =====
2025-08-29 06:46:50,983 - __main__ - INFO - ===== 任务执行结束：success =====
{
  "status": "success",
  "task": "crawl_etf_daily",
  "message": "ETF日线数据增量爬取完成"
}
